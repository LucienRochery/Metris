//Metris: high-order metric-based non-manifold tetrahedral remesher
//Copyright (C) 2023-2024, Massachusetts Institute of Technology
//Licensed under The GNU Lesser General Public License, version 2.1
//See /License.txt or http://www.opensource.org/licenses/lgpl-2.1.php



#ifndef __HO_QUADRATURE__
#define __HO_QUADRATURE__


namespace Metris{
     
/*
     --- Tetrahedron quadrature rule (0 = 1.0e-8)
     https://people.sc.fsu.edu/~jburkardt/datasets/quadrature_rules_tet/quadrature_rules_tet.html

     214 point Xiao Gimbutas 15 (Quadpy) for excessive precision 
     (exact up to deg 15 or P^2 quadrature of P^3 funcs on P^2 meshes)

    Will replace with less overkill, this is mostly to isolate the effect of poor qual/optim implementation.
*/

// These two are wrong
//constexpr int nquad_XG15 = 214;
//constexpr int nquad_sym9 = 59;
constexpr int nquad_Keaton6 = 24;



const double tuvquad_Keaton6[24][3] = {{0.214602871259151684e0,0.214602871259151684e0,0.214602871259151684e0},
                                       {0.356191386222544953e0,0.214602871259151684e0,0.214602871259151684e0},
                                       {0.214602871259151684e0,0.356191386222544953e0,0.214602871259151684e0},
                                       {0.214602871259151684e0,0.214602871259151684e0,0.356191386222544953e0},
                                       {4.06739585346113397e-2,4.06739585346113397e-2,4.06739585346113397e-2},
                                       {0.877978124396165982e0,4.06739585346113397e-2,4.06739585346113397e-2},
                                       {4.06739585346113397e-2,0.877978124396165982e0,4.06739585346113397e-2},
                                       {4.06739585346113397e-2,4.06739585346113397e-2,0.877978124396165982e0},
                                       {0.322337890142275646e0,0.322337890142275646e0,0.322337890142275646e0},
                                       {3.29863295731730594e-2,0.322337890142275646e0,0.322337890142275646e0},
                                       {0.322337890142275646e0,3.29863295731730594e-2,0.322337890142275646e0},
                                       {0.322337890142275646e0,0.322337890142275646e0,3.29863295731730594e-2},
                                       {6.36610018750175299e-2,6.36610018750175299e-2,0.269672331458315867e0},
                                       {6.36610018750175299e-2,6.36610018750175299e-2,0.603005664791649076e0},
                                       {6.36610018750175299e-2,0.269672331458315867e0,6.36610018750175299e-2},
                                       {6.36610018750175299e-2,0.603005664791649076e0,6.36610018750175299e-2},
                                       {0.269672331458315867e0,6.36610018750175299e-2,6.36610018750175299e-2},
                                       {0.603005664791649076e0,6.36610018750175299e-2,6.36610018750175299e-2},
                                       {6.36610018750175299e-2,0.269672331458315867e0,0.603005664791649076e0},
                                       {6.36610018750175299e-2,0.603005664791649076e0,0.269672331458315867e0},
                                       {0.269672331458315867e0,6.36610018750175299e-2,0.603005664791649076e0},
                                       {0.603005664791649076e0,6.36610018750175299e-2,0.269672331458315867e0},
                                       {0.269672331458315867e0,0.603005664791649076e0,6.36610018750175299e-2},
                                       {0.603005664791649076e0,0.269672331458315867e0,6.36610018750175299e-2}};
     
const double wtquad_Keaton6[24] = { 0.665379170969464506e-2,
                                    0.665379170969464506e-2,
                                    0.665379170969464506e-2,
                                    0.665379170969464506e-2,
                                    0.167953517588677620e-2,
                                    0.167953517588677620e-2,
                                    0.167953517588677620e-2,
                                    0.167953517588677620e-2,
                                    0.922619692394239843e-2,
                                    0.922619692394239843e-2,
                                    0.922619692394239843e-2,
                                    0.922619692394239843e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2,
                                    0.803571428571428248e-2};
    
//const double tuvquad_sym9[59][3] ={0.25                   , 0.25                  , 0.25                  ,
//                   6.198169755222693e-10 , 6.198169755222693e-10 , 0.999999998140549     ,
//                   6.198169755222693e-10 , 0.999999998140549     , 6.198169755222693e-10 ,
//                   0.999999998140549     , 6.198169755222693e-10 , 6.198169755222693e-10 ,
//                   6.198169755222693e-10 , 6.198169755222693e-10 , 6.198169755222693e-10 ,
//                   0.1607745353952616    , 0.1607745353952616    , 0.5176763938142153    ,
//                   0.1607745353952616    , 0.5176763938142153    , 0.1607745353952616    ,
//                   0.5176763938142153    , 0.1607745353952616    , 0.1607745353952616    ,
//                   0.1607745353952616    , 0.1607745353952616    , 0.1607745353952616    ,
//                   0.32227652182142097   , 0.32227652182142097   , 0.03317043453573709   ,
//                   0.32227652182142097   , 0.03317043453573709   , 0.32227652182142097   ,
//                   0.03317043453573709   , 0.32227652182142097   , 0.32227652182142097   ,
//                   0.32227652182142097   , 0.32227652182142097   , 0.32227652182142097   ,
//                   0.045108918345413584  , 0.045108918345413584  , 0.8646732449637593    ,
//                   0.045108918345413584  , 0.8646732449637593    , 0.045108918345413584  ,
//                   0.8646732449637593    , 0.045108918345413584  , 0.045108918345413584  ,
//                   0.045108918345413584  , 0.045108918345413584  , 0.045108918345413584  ,
//                   0.11229654600437605   , 0.38770345399562395   , 0.38770345399562395   ,
//                   0.38770345399562395   , 0.11229654600437605   , 0.38770345399562395   ,
//                   0.11229654600437605   , 0.11229654600437605   , 0.38770345399562395   ,
//                   0.11229654600437605   , 0.38770345399562395   , 0.11229654600437605   ,
//                   0.38770345399562395   , 0.11229654600437605   , 0.11229654600437605   ,
//                   0.38770345399562395   , 0.38770345399562395   , 0.11229654600437605   ,
//                   0.0025545792330413097 , 0.4588714487524593    , 0.07970252326204014   ,
//                   0.0025545792330413097 , 0.4588714487524593    , 0.4588714487524593    ,
//                   0.4588714487524593    , 0.4588714487524593    , 0.0025545792330413097 ,
//                   0.07970252326204014   , 0.0025545792330413097 , 0.4588714487524593    ,
//                   0.4588714487524593    , 0.07970252326204014   , 0.0025545792330413097 ,
//                   0.4588714487524593    , 0.0025545792330413097 , 0.4588714487524593    ,
//                   0.07970252326204014   , 0.4588714487524593    , 0.0025545792330413097 ,
//                   0.4588714487524593    , 0.07970252326204014   , 0.4588714487524593    ,
//                   0.4588714487524593    , 0.4588714487524593    , 0.07970252326204014   ,
//                   0.4588714487524593    , 0.0025545792330413097 , 0.07970252326204014   ,
//                   0.07970252326204014   , 0.4588714487524593    , 0.4588714487524593    ,
//                   0.0025545792330413097 , 0.07970252326204014   , 0.4588714487524593    ,
//                   0.7183503264420745    , 0.033775870685338605  , 0.21409793218724832   ,
//                   0.7183503264420745    , 0.033775870685338605  , 0.033775870685338605  ,
//                   0.033775870685338605  , 0.033775870685338605  , 0.7183503264420745    ,
//                   0.21409793218724832   , 0.7183503264420745    , 0.033775870685338605  ,
//                   0.033775870685338605  , 0.21409793218724832   , 0.7183503264420745    ,
//                   0.033775870685338605  , 0.7183503264420745    , 0.033775870685338605  ,
//                   0.21409793218724832   , 0.033775870685338605  , 0.7183503264420745    ,
//                   0.033775870685338605  , 0.21409793218724832   , 0.033775870685338605  ,
//                   0.033775870685338605  , 0.033775870685338605  , 0.21409793218724832   ,
//                   0.033775870685338605  , 0.7183503264420745    , 0.21409793218724832   ,
//                   0.21409793218724832   , 0.033775870685338605  , 0.033775870685338605  ,
//                   0.7183503264420745    , 0.21409793218724832   , 0.033775870685338605  ,
//                   0.03441591057817528   , 0.1836413698099279    , 0.5983013498019689    ,
//                   0.03441591057817528   , 0.1836413698099279    , 0.1836413698099279    ,
//                   0.1836413698099279    , 0.1836413698099279    , 0.03441591057817528   ,
//                   0.5983013498019689    , 0.03441591057817528   , 0.1836413698099279    ,
//                   0.1836413698099279    , 0.5983013498019689    , 0.03441591057817528   ,
//                   0.1836413698099279    , 0.03441591057817528   , 0.1836413698099279    ,
//                   0.5983013498019689    , 0.1836413698099279    , 0.03441591057817528   ,
//                   0.1836413698099279    , 0.5983013498019689    , 0.1836413698099279    ,
//                   0.1836413698099279    , 0.1836413698099279    , 0.5983013498019689    ,
//                   0.1836413698099279    , 0.03441591057817528   , 0.5983013498019689    ,
//                   0.5983013498019689    , 0.1836413698099279    , 0.1836413698099279    ,
//                   0.03441591057817528   , 0.5983013498019689    , 0.1836413698099279 };
//
//const double wtquad_sym9[59] = { 0.05801054891248025e0/6     ,
//                                 6.43192817592564e-05/6    ,
//                                 6.43192817592564e-05/6    ,
//                                 6.43192817592564e-05/6    ,
//                                 6.43192817592564e-05/6    ,
//                                 0.023173338462425457e0/6  ,
//                                 0.023173338462425457e0/6  ,
//                                 0.023173338462425457e0/6  ,
//                                 0.023173338462425457e0/6  ,
//                                 0.029562912335429285e0/6  ,
//                                 0.029562912335429285e0/6  ,
//                                 0.029562912335429285e0/6  ,
//                                 0.029562912335429285e0/6  ,
//                                 0.008063979979616182e0/6  ,
//                                 0.008063979979616182e0/6  ,
//                                 0.008063979979616182e0/6  ,
//                                 0.008063979979616182e0/6  ,
//                                 0.038134080103702464e0/6  ,
//                                 0.038134080103702464e0/6  ,
//                                 0.038134080103702464e0/6  ,
//                                 0.038134080103702464e0/6  ,
//                                 0.038134080103702464e0/6  ,
//                                 0.038134080103702464e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.008384422198298552e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.010234559352745328e0/6  ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6   ,
//                                 0.02052491596798814e0/6};
//
//
//const double tuvquad_XG15[214][3] = {
//    0.02484175292278384, 0.008848046489432548, 0.9372660613009632, 
//    0.008848046489437518, 0.02904413928681676, 0.9372660613009608, 
//    0.02904413928681213, 0.02484175292278018, 0.9372660613009554, 
//    0.003073684779436487, 0.2792517608130759, 0.007826636168369566, 
//    0.709847918239126, 0.003073684779447072, 0.007826636168374292, 
//    0.2792517608130549, 0.7098479182391227, 0.007826636168374732, 
//    0.8851662080559259, 0.01941685525440453, 0.09225347133747239, 
//    0.01941685525440571, 0.003163465352201491, 0.09225347133747905, 
//    0.003163465352203353, 0.8851662080559214, 0.09225347133747011, 
//    0.02062270623222065, 0.9433792085073393, 0.01608597865131358, 
//    0.943379208507337, 0.01991210660912664, 0.01608597865131474, 
//    0.01991210660912658, 0.02062270623222047, 0.01608597865131562, 
//    0.1095755475481473, 0.01464021932495235, 0.8630127527658966, 
//    0.01277148036100595, 0.1095755475481476, 0.8630127527658954, 
//    0.01464021932495353, 0.012771480361006, 0.8630127527659015, 
//    0.01034990660067171, 0.7426915834872547, 0.01167275911784623, 
//    0.2352857507942327, 0.01034990660067426, 0.0116727591178434, 
//    0.7426915834872502, 0.2352857507942241, 0.01167275911784928, 
//    0.0133390399676393, 0.3718583817617002, 0.6057046365583734, 
//    0.3718583817617083, 0.009097941712290891, 0.6057046365583626, 
//    0.009097941712294314, 0.01333903996763977, 0.6057046365583639, 
//    0.5249771861414798, 0.01367226401253988, 0.01029208189692955, 
//    0.01367226401254362, 0.4510584679490587, 0.01029208189693136, 
//    0.4510584679490486, 0.5249771861414734, 0.01029208189693373, 
//    0.0745911424654928, 0.09342069694332726, 0.004110311725985602, 
//    0.8278778488651856, 0.07459114246549663, 0.004110311725986349, 
//    0.0934206969433283, 0.8278778488651842, 0.004110311725989205, 
//    0.0122514981411758, 0.11081079369917, 0.01880574820318091, 
//    0.1108107936991686, 0.8581319599564727, 0.01880574820318023, 
//    0.85813195995647, 0.01225149814117781, 0.01880574820318224, 
//    0.01511843542458239, 0.04765944606068975, 0.0750995589695265, 
//    0.04765944606069021, 0.8621225595452037, 0.07509955896952418, 
//    0.8621225595452005, 0.01511843542458308, 0.0750995589695319, 
//    0.1361581213833478, 0.001922023464433764, 0.2260822299666647, 
//    0.6358376251855543, 0.13615812138335, 0.2260822299666622, 
//    0.001922023464443689, 0.6358376251855318, 0.2260822299666766, 
//    0.01376037881840447, 0.7415160297079681, 0.2282126571617323, 
//    0.741516029707964, 0.01651093431189725, 0.2282126571617314, 
//    0.01651093431189804, 0.01376037881840719, 0.2282126571617405, 
//    0.5287234935734707, 0.3829175522239497, 0.08835752618992757, 
//    1.428012658284353e-06, 0.5287234935734723, 0.08835752618992139, 
//    0.382917552223954, 1.428012662889333e-06, 0.0883575261899238, 
//    0.8603078190745503, 0.1006669391238628, 0.02182336879483741, 
//    0.1006669391238637, 0.01720187300674862, 0.02182336879483792, 
//    0.01720187300674926, 0.8603078190745502, 0.0218233687948384, 
//    0.213749749548486, 0.003009152671000964, 0.6883673506451037, 
//    0.003009152671001727, 0.09487374713541114, 0.6883673506451042, 
//    0.09487374713541051, 0.213749749548485, 0.6883673506450955, 
//    0.01776885891901024, 0.5596471440071771, 0.4090155222479943, 
//    0.5596471440071775, 0.01356847482581952, 0.4090155222479928, 
//    0.01356847482581988, 0.01776885891900956, 0.4090155222479974, 
//    0.5561861612025368, 0.07185958939197906, 0.3631251266370949, 
//    0.07185958939199275, 0.008829122768390513, 0.3631251266370967, 
//    0.008829122768396735, 0.556186161202529, 0.3631251266370916, 
//    0.02153556644467808, 0.01948609324379375, 0.7368319066698201, 
//    0.01948609324379522, 0.2221464336417116, 0.7368319066698122, 
//    0.2221464336417159, 0.02153556644468099, 0.736831906669808, 
//    0.7706018404420292, 0.01488093241522564, 0.1457507819888409, 
//    0.01488093241522547, 0.06876644515390219, 0.1457507819888461, 
//    0.06876644515390468, 0.7706018404420206, 0.1457507819888496, 
//    0.2632140692833737, 0.5416447947584936, 0.1940096424521396, 
//    0.5416447947584961, 0.001131493505992412, 0.1940096424521405, 
//    0.001131493505999361, 0.2632140692833789, 0.1940096424521402, 
//    0.5866866785337993, 0.3700027679954775, 0.01920458791743641, 
//    0.02410596555328862, 0.5866866785337975, 0.01920458791743763, 
//    0.3700027679954874, 0.02410596555328817, 0.01920458791743828, 
//    0.1007245253786872, 0.007839833208067415, 0.681257697378422, 
//    0.007839833208073724, 0.2101779440348198, 0.6812576973784202, 
//    0.2101779440348183, 0.1007245253786925, 0.6812576973784144, 
//    0.2678058473170444, 0.009653727838177417, 0.3203870289323185, 
//    0.009653727838177781, 0.4021533959124907, 0.3203870289323026, 
//    0.4021533959124549, 0.2678058473170257, 0.3203870289323365, 
//    0.01871950766556472, 0.07877407681846821, 0.8174647095402787, 
//    0.07877407681846901, 0.08504170597569094, 0.8174647095402758, 
//    0.08504170597569295, 0.01871950766556529, 0.8174647095402776, 
//    0.2289622580755599, 0.7059180690514001, 0.01703231872933662, 
//    0.7059180690513981, 0.04808735414370217, 0.01703231872933689, 
//    0.04808735414368957, 0.2289622580755674, 0.01703231872933699, 
//    0.01343952012215375, 0.188978322150464, 0.07671766832162848, 
//    0.1889783221504602, 0.7208644894057589, 0.07671766832162524, 
//    0.7208644894057502, 0.01343952012215593, 0.07671766832162946, 
//    0.1856695714205305, 0.00940743474102812, 0.498715106027506, 
//    0.3062078878109278, 0.1856695714205285, 0.4987151060275142, 
//    0.009407434741032658, 0.306207887810909, 0.4987151060275297, 
//    0.07134313304985408, 0.7168988880207371, 0.01586351574919136, 
//    0.7168988880207331, 0.1958944631802114, 0.01586351574919187, 
//    0.1958944631802093, 0.07134313304985869, 0.01586351574919585, 
//    0.6081230921397938, 0.01132540328384632, 0.2960917880883974, 
//    0.01132540328384961, 0.08445971648796122, 0.2960917880884005, 
//    0.08445971648796277, 0.6081230921397877, 0.2960917880884, 
//    0.7831901908047053, 0.08946628745362917, 0.1093980943900156, 
//    0.01794542735164876, 0.7831901908046981, 0.1093980943900213, 
//    0.08946628745363563, 0.01794542735165081, 0.1093980943900156, 
//    0.5244117804550043, 0.2084577994081171, 0.01133447823052404, 
//    0.2084577994081089, 0.255795941906351, 0.01133447823052516, 
//    0.2557959419063432, 0.5244117804550297, 0.01133447823052761, 
//    0.01588261437502311, 0.3863456880386881, 0.5325804036187812, 
//    0.06519129396751876, 0.0158826143750247, 0.5325804036187707, 
//    0.3863456880386817, 0.0651912939675148, 0.5325804036187769, 
//    0.03236911071658531, 0.6667349326998179, 0.2320665678040404, 
//    0.06882938877957372, 0.03236911071658261, 0.2320665678040363, 
//    0.6667349326998023, 0.06882938877957215, 0.2320665678040363, 
//    0.2154208621405496, 0.01783785666517354, 0.07794412055941285, 
//    0.01783785666517584, 0.6887971606348672, 0.07794412055941696, 
//    0.6887971606348626, 0.2154208621405385, 0.07794412055942193, 
//    0.4031765079784496, 0.01499093171087654, 0.5021066311640049, 
//    0.01499093171087712, 0.07972592914667045, 0.5021066311640021, 
//    0.07972592914666891, 0.4031765079784464, 0.5021066311640048, 
//    0.1848636811678036, 0.6499516355495718, 0.0182999648331871, 
//    0.6499516355495523, 0.1468847184494371, 0.01829996483318704, 
//    0.1468847184494266, 0.184863681167814, 0.01829996483318721, 
//    0.1804453441648688, 0.451820102412822, 0.3540241023636928, 
//    0.01371045105861957, 0.1804453441648663, 0.3540241023636804, 
//    0.4518201024128161, 0.01371045105861805, 0.3540241023636947, 
//    0.08105206237388583, 0.3766532156247404, 0.01518945086644218, 
//    0.5271052711349223, 0.08105206237388458, 0.01518945086644177, 
//    0.3766532156247387, 0.5271052711349294, 0.01518945086644269, 
//    0.331408497762104, 0.1126435977537889, 0.0134868064234796, 
//    0.5424610980606107, 0.3314084977621181, 0.01348680642347998, 
//    0.1126435977537936, 0.5424610980606109, 0.01348680642348059, 
//    0.5607935139776807, 0.01909773271486895, 0.06348929065765115, 
//    0.01909773271486825, 0.3566194626497967, 0.06348929065765373, 
//    0.3566194626497901, 0.5607935139776836, 0.0634892906576574, 
//    0.07227368768344591, 0.2738988990502447, 0.6053416400059596, 
//    0.04848577326034448, 0.07227368768344192, 0.6053416400059548, 
//    0.2738988990502546, 0.04848577326034462, 0.6053416400059433, 
//    0.3706144545187708, 0.01602307963396246, 0.1897016601820003, 
//    0.01602307963396413, 0.4236608056652554, 0.1897016601819962, 
//    0.4236608056652498, 0.3706144545187751, 0.1897016601820099, 
//    0.07313934036770678, 0.06778253195192757, 0.7047038738820789, 
//    0.1543742537982787, 0.0731393403677088, 0.7047038738820692, 
//    0.06778253195194402, 0.1543742537982604, 0.7047038738820758, 
//    0.2255550687888375, 0.3828261323216449, 0.01264429188566553, 
//    0.3828261323216364, 0.3789745070038535, 0.01264429188566583, 
//    0.3789745070038492, 0.2255550687888252, 0.01264429188566767, 
//    0.01610664762850615, 0.1955976722408662, 0.504888949609758, 
//    0.1955976722408699, 0.2834067305208563, 0.5048889496097685, 
//    0.2834067305208526, 0.01610664762850647, 0.5048889496097625, 
//    0.07394396840975409, 0.08972209215481677, 0.06088720165051376, 
//    0.7754467377849116, 0.07394396840975978, 0.06088720165051331, 
//    0.08972209215481254, 0.7754467377849096, 0.06088720165051947, 
//    0.02198550415554825, 0.4522698873067332, 0.3656528451019294, 
//    0.4522698873067705, 0.1600917634357737, 0.3656528451019036, 
//    0.1600917634358059, 0.02198550415555332, 0.3656528451018906, 
//    0.6425340162574237, 0.03023340240085394, 0.1777342490770398, 
//    0.1494983322647011, 0.6425340162574126, 0.1777342490770339, 
//    0.03023340240085156, 0.1494983322646933, 0.1777342490770401, 
//    0.2982386203137134, 0.3492984375384283, 0.3282766894848435, 
//    0.02418625266301134, 0.2982386203137263, 0.3282766894848561, 
//    0.3492984375384166, 0.02418625266301722, 0.3282766894848335, 
//    0.02492578585848872, 0.5613484323473249, 0.1898351044830521, 
//    0.2238906773111161, 0.02492578585848644, 0.1898351044830608, 
//    0.5613484323473145, 0.22389067731113, 0.1898351044830645, 
//    0.1769461529053036, 0.05090872345953187, 0.6068946490861404, 
//    0.1652504745490214, 0.1769461529053149, 0.6068946490861201, 
//    0.05090872345953583, 0.1652504745490102, 0.6068946490861318, 
//    0.267326785868413, 0.09253312310838845, 0.162728234374953, 
//    0.09253312310841946, 0.4774118566482484, 0.1627282343749322, 
//    0.4774118566482272, 0.2673267858684251, 0.162728234374927, 
//    0.6324086041104882, 0.194821777558372, 0.07976498347271095, 
//    0.09300463485842678, 0.6324086041104942, 0.0797649834727117, 
//    0.1948217775583615, 0.09300463485842231, 0.07976498347272819, 
//    0.1286081121536503, 0.06206882668877994, 0.5069361346327252, 
//    0.3023869265248393, 0.1286081121536543, 0.5069361346327149, 
//    0.06206882668879442, 0.3023869265248427, 0.5069361346327274, 
//    0.0670060501118351, 0.07446918750056565, 0.362874044201665, 
//    0.4956507181859352, 0.06700605011182939, 0.3628740442016639, 
//    0.07446918750057789, 0.4956507181859199, 0.3628740442016637, 
//    0.04935190074328522, 0.3139246227522204, 0.1497252367121568, 
//    0.3139246227522261, 0.4869982397923315, 0.1497252367121615, 
//    0.4869982397923459, 0.04935190074327669, 0.149725236712158, 
//    0.1083529025389752, 0.08656298623704123, 0.1758982241285937, 
//    0.629185887095386, 0.1083529025389925, 0.1758982241285794, 
//    0.08656298623703901, 0.629185887095383, 0.1758982241285948, 
//    0.4947915054658847, 0.3668061114674768, 0.0797762381765776, 
//    0.05862614489007139, 0.4947915054658749, 0.07977623817658046, 
//    0.3668061114674683, 0.05862614489007745, 0.07977623817658072, 
//    0.6107564898848346, 0.09155687274905353, 0.08682921283620239, 
//    0.2108574245299135, 0.6107564898848316, 0.0868292128362, 
//    0.09155687274905454, 0.2108574245299094, 0.08682921283620657, 
//    0.27189840912706, 0.2718984091270191, 0.1843047726189553, 
//    0.08364528610473303, 0.4598959913496589, 0.2836943220226789, 
//    0.4598959913496499, 0.1727644005229201, 0.2836943220226703, 
//    0.1727644005229245, 0.0836452861047611, 0.2836943220226696, 
//    0.220307180915872, 0.2203071809158613, 0.3390784572525623, 
//    0.4498492745599813, 0.1402964159526019, 0.06810558755187382, 
//    0.3417487219355564, 0.4498492745599653, 0.0681055875518764, 
//    0.1402964159526053, 0.3417487219355464, 0.06810558755187403, 
//    0.4796245561760771, 0.06988987460087778, 0.2572931400794461, 
//    0.1931924291436032, 0.4796245561760668, 0.2572931400794509, 
//    0.06988987460089365, 0.1931924291436036, 0.2572931400794577, 
//    0.4819852013641325, 0.2605590256904803, 0.06519355736441289, 
//    0.260559025690468, 0.1922622155809665, 0.06519355736441458, 
//    0.1922622155809799, 0.481985201364128, 0.06519355736441629, 
//    0.09109001795840514, 0.343030573977829, 0.2354338687541656, 
//    0.3304455393096081, 0.09109001795841783, 0.2354338687541547, 
//    0.343030573977809, 0.3304455393095925, 0.2354338687541694, 
//    0.08624240167701186, 0.1525520261883117, 0.4323311285083857, 
//    0.3288744436262873, 0.0862424016770105, 0.4323311285083789, 
//    0.1525520261883389, 0.3288744436262735, 0.4323311285083771, 
//    0.3337847727363109, 0.3372700741462638, 0.1536568898623008, 
//    0.3372700741462386, 0.1752882632551174, 0.1536568898623003, 
//    0.1752882632551262, 0.333784772736308, 0.1536568898623202, 
//    0.3113177461109946, 0.3113177461109871, 0.06604676166701309, 
//    0.2898527003164425, 0.2359060680311884, 0.3891009454304513, 
//    0.2359060680311902, 0.08514028622192746, 0.3891009454304601, 
//    0.0851402862219274, 0.2898527003164147, 0.38910094543047, 
//    0.1915586123296988, 0.4738597830753307, 0.1624688668332693, 
//    0.4738597830753175, 0.1721127377617093, 0.1624688668332666, 
//    0.1721127377617219, 0.1915586123296906, 0.1624688668332857, 
//    0.343066772448071, 0.1725513660667974, 0.2910280425505992, 
//    0.1933538189344859, 0.3430667724481031, 0.2910280425505916, 
//    0.1725513660668472, 0.1933538189345398, 0.2910280425506466, 
//    0.1627284320161738, 0.1627284320161655, 0.5118147039514781};
//
//
//const double wtquad_XG15[214] = {0.0003056969967675392/6,
//                                 0.0003056969967677529/6,
//                                 0.0003056969967681826/6,
//                                 0.0004854946815200308/6,
//                                 0.0004854946815204648/6,
//                                 0.0004854946815205046/6,
//                                 0.000540231508089061/6,
//                                 0.0005402315080893089/6,
//                                 0.0005402315080893216/6,
//                                 0.0006658073061313105/6,
//                                 0.000665807306131382/6,
//                                 0.0006658073061313881/6,
//                                 0.0008580677785378436/6,
//                                 0.0008580677785378866/6,
//                                 0.0008580677785379431/6,
//                                 0.0008614116841663662/6,
//                                 0.0008614116841664157/6,
//                                 0.000861411684166711/6,
//                                 0.001022857153872907/6,
//                                 0.00102285715387307/6,
//                                 0.001022857153873352/6,
//                                 0.001067732783063372/6,
//                                 0.001067732783063678/6,
//                                 0.001067732783063917/6,
//                                 0.001127475060480442/6,
//                                 0.001127475060480499/6,
//                                 0.001127475060480686/6,
//                                 0.001131195261071419/6,
//                                 0.001131195261071527/6,
//                                 0.001131195261071613/6,
//                                 0.001220520643534932/6,
//                                 0.001220520643534937/6,
//                                 0.001220520643535107/6,
//                                 0.001429872152287352/6,
//                                 0.001429872152287716/6,
//                                 0.001429872152288791/6,
//                                 0.001482149442565798/6,
//                                 0.001482149442566192/6,
//                                 0.001482149442566206/6,
//                                 0.00155092314083083/6,
//                                 0.001550923140831266/6,
//                                 0.001550923140831712/6,
//                                 0.001593499385594808/6,
//                                 0.001593499385594812/6,
//                                 0.001593499385594864/6,
//                                 0.001786124981508196/6,
//                                 0.001786124981508356/6,
//                                 0.001786124981509098/6,
//                                 0.001793662924059105/6,
//                                 0.001793662924059139/6,
//                                 0.001793662924059193/6,
//                                 0.001923299718752182/6,
//                                 0.001923299718752746/6,
//                                 0.001923299718753172/6,
//                                 0.002011193038001121/6,
//                                 0.002011193038001399/6,
//                                 0.002011193038001518/6,
//                                 0.002145067125715038/6,
//                                 0.002145067125715266/6,
//                                 0.002145067125715382/6,
//                                 0.002259956184833013/6,
//                                 0.002259956184833064/6,
//                                 0.002259956184833895/6,
//                                 0.002502336027424191/6,
//                                 0.00250233602742444/6,
//                                 0.002502336027424529/6,
//                                 0.002524144856161971/6,
//                                 0.002524144856162738/6,
//                                 0.002524144856163086/6,
//                                 0.002642042663514365/6,
//                                 0.002642042663514703/6,
//                                 0.002642042663516116/6,
//                                 0.002706105653967578/6,
//                                 0.002706105653967593/6,
//                                 0.002706105653967675/6,
//                                 0.002885552163891226/6,
//                                 0.002885552163891232/6,
//                                 0.002885552163891362/6,
//                                 0.002953010108381281/6,
//                                 0.002953010108381412/6,
//                                 0.002953010108381639/6,
//                                 0.002983590683044804/6,
//                                 0.002983590683045283/6,
//                                 0.002983590683046027/6,
//                                 0.00302772576899869/6,
//                                 0.003027725768998906/6,
//                                 0.003027725768999417/6,
//                                 0.003032163997553845/6,
//                                 0.003032163997554297/6,
//                                 0.0030321639975545/6,
//                                 0.003044930460448902/6,
//                                 0.003044930460448908/6,
//                                 0.003044930460449175/6,
//                                 0.003177770176097537/6,
//                                 0.003177770176097727/6,
//                                 0.003177770176098164/6,
//                                 0.00357683467377095/6,
//                                 0.003576834673771061/6,
//                                 0.00357683467377161/6,
//                                 0.003637919636949187/6,
//                                 0.003637919636949817/6,
//                                 0.003637919636950729/6,
//                                 0.003783064132578251/6,
//                                 0.003783064132578551/6,
//                                 0.003783064132578869/6,
//                                 0.003894262403078457/6,
//                                 0.00389426240307858/6,
//                                 0.003894262403079241/6,
//                                 0.004070803346596639/6,
//                                 0.00407080334659724/6,
//                                 0.004070803346597384/6,
//                                 0.004211243246972996/6,
//                                 0.004211243246973595/6,
//                                 0.004211243246973616/6,
//                                 0.00422699916760202/6,
//                                 0.004226999167602049/6,
//                                 0.004226999167602123/6,
//                                 0.004273926513753401/6,
//                                 0.004273926513753788/6,
//                                 0.004273926513753894/6,
//                                 0.004308504303089285/6,
//                                 0.004308504303089388/6,
//                                 0.004308504303089446/6,
//                                 0.004392057502532474/6,
//                                 0.004392057502532598/6,
//                                 0.004392057502533357/6,
//                                 0.004492517660341751/6,
//                                 0.004492517660341976/6,
//                                 0.004492517660342421/6,
//                                 0.004579874507811634/6,
//                                 0.004579874507812269/6,
//                                 0.004579874507812551/6,
//                                 0.004599070752114356/6,
//                                 0.004599070752114688/6,
//                                 0.004599070752114752/6,
//                                 0.004696109559169662/6,
//                                 0.004696109559169847/6,
//                                 0.004696109559170298/6,
//                                 0.004929877659368443/6,
//                                 0.004929877659368461/6,
//                                 0.004929877659368522/6,
//                                 0.005041142997483998/6,
//                                 0.005041142997484595/6,
//                                 0.005041142997485244/6,
//                                 0.005189814738676072/6,
//                                 0.005189814738676105/6,
//                                 0.005189814738676132/6,
//                                 0.005862649637774474/6,
//                                 0.005862649637775227/6,
//                                 0.005862649637775519/6,
//                                 0.006019356842665673/6,
//                                 0.006019356842665738/6,
//                                 0.006019356842666802/6,
//                                 0.006664241269270311/6,
//                                 0.006664241269270803/6,
//                                 0.006664241269271095/6,
//                                 0.006924716651495637/6,
//                                 0.006924716651498002/6,
//                                 0.006924716651498908/6,
//                                 0.007133321868983811/6,
//                                 0.007133321868984118/6,
//                                 0.007133321868984706/6,
//                                 0.007223589048729577/6,
//                                 0.007223589048730604/6,
//                                 0.007223589048730717/6,
//                                 0.0076065288605441/6,
//                                 0.007606528860544255/6,
//                                 0.007606528860544914/6,
//                                 0.00784520802719414/6,
//                                 0.007845208027194517/6,
//                                 0.007845208027194631/6,
//                                 0.008031659876681006/6,
//                                 0.008031659876681413/6,
//                                 0.008031659876682378/6,
//                                 0.008072813858538199/6,
//                                 0.00807281385853882/6,
//                                 0.00807281385853888/6,
//                                 0.008390149171535615/6,
//                                 0.008390149171536085/6,
//                                 0.008390149171536607/6,
//                                 0.00907033305470961/6,
//                                 0.009220976407669668/6,
//                                 0.00922097640767155/6,
//                                 0.00922097640767167/6,
//                                 0.009410980595668464/6,
//                                 0.00982302304621952/6,
//                                 0.009823023046219964/6,
//                                 0.00982302304622013/6,
//                                 0.01000805918911805/6,
//                                 0.01000805918911809/6,
//                                 0.01000805918912071/6,
//                                 0.01008084911055904/6,
//                                 0.01008084911055905/6,
//                                 0.01008084911055952/6,
//                                 0.01014728880161914/6,
//                                 0.01014728880161932/6,
//                                 0.01014728880162128/6,
//                                 0.01085611465241084/6,
//                                 0.01085611465241102/6,
//                                 0.01085611465241139/6,
//                                 0.01096256609141757/6,
//                                 0.0109625660914211/6,
//                                 0.01096256609142445/6,
//                                 0.01124830065119754/6,
//                                 0.01133531439294629/6,
//                                 0.01133531439294871/6,
//                                 0.01133531439294929/6,
//                                 0.01145767025398285/6,
//                                 0.01145767025398439/6,
//                                 0.01145767025398631/6,
//                                 0.01229675142111412/6,
//                                 0.01229675142111414/6,
//                                 0.01229675142112366/6,
//                                 0.01444493731864532/6};

/*
For now, tabulate Bernstein and Lagranges at commonly used barycentric coordinates:
- regularly spaced nodes
- quadrature rules

eval3 refers to tetrahedra
*/

//struct bernstein_eval3_uninodes_constructor{
//	constexpr bernstein_eval_uninodes_constructor() : s(){
//		for(int ideg = 0;ideg <= METRIS_MAX_DEG; ideg++){
//			for(int inode = 0;inode < tetnpps[ideg]; inode++){
//				double bary[4] = {ordtet.s[ideg][inode]/(1.0*ideg),
//													ordtet.s[ideg][inode]/(1.0*ideg),
//   												ordtet.s[ideg][inode]/(1.0*ideg),
//   												ordtet.s[ideg][inode]/(1.0*ideg)}
//				eval[ideg][inode] = 
//				   eval_bezier<ideg,3>(ordtet.s[ideg][inode],bary,0,jmat[ideg][inode])
//
//			}
//		}
//	}
//	double eval[1+METRIS_MAX_DEG][tetnpps[METRIS_MAX_DEG]];
//	double jmat[1+METRIS_MAX_DEG][tetnpps[METRIS_MAX_DEG]];
//}
//
} // End namespace

#endif